<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../">
  <title data-ice="title">src/screens/subscreens/resources/Graphs.jsx | newbank</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-LoadingProvider">LoadingProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-useLoading">useLoading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Main">Main</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-LoadingContext">LoadingContext</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components">components</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ArrowBack">ArrowBack</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ChangeData">ChangeData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-LogoImage">LogoImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MoneysGraph">MoneysGraph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TooltipComp">TooltipComp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-homecomponents">components/homeComponents</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Balance">Balance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Header">Header</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-HomeModal">HomeModal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-HorizontalMenuOption">HorizontalMenuOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Menu">Menu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MoreOptions">MoreOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MovementRegister">MovementRegister</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Movements">Movements</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#database">database</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/database/firebaseDBMethods.js~DBStorage.html">DBStorage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/database/firebaseStorageMethods.js~Storage.html">Storage</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#screens">screens</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AuthScreen">AuthScreen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Home">Home</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Perfil">Perfil</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Settings">Settings</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#screens-subscreens">screens/subscreens</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ChangeProfilePic">ChangeProfilePic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-InvestmentsCheckbox">InvestmentsCheckbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SaveInvestments">SaveInvestments</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SplashScreen">SplashScreen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TypeOfPic">TypeOfPic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-UploadPic">UploadPic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-WebViewScreen">WebViewScreen</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#screens-subscreens-resources">screens/subscreens/resources</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Graphs">Graphs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-MapLoadingScreen">MapLoadingScreen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Money">Money</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SeePicture">SeePicture</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#server">server</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/apidata.js~ApiRequests.html">ApiRequests</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/server/events_api.js~EventsApi.html">EventsApi</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/screens/subscreens/resources/Graphs.jsx</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React, { useEffect, useState } from &quot;react&quot;;
import { Dimensions, View, StyleSheet, Text, ScrollView, TouchableOpacity, StatusBar } from &quot;react-native&quot;;
import { PieChart, BarChart, LineChart } from &quot;react-native-chart-kit&quot;;
import FlashMessage, { showMessage } from &quot;react-native-flash-message&quot;;
import { Ionicons } from &apos;@expo/vector-icons&apos;;

import { useLoading } from &quot;../../../Context&quot;;


const screenWidth = Dimensions.get(&quot;window&quot;).width;
const statusBarHeight = StatusBar.currentHeight ? StatusBar.currentHeight + 5 : 64;


export default function Graphs({ route, navigation }) {

    const { showLoading, hideLoading } = useLoading();

    const [moneyFlow, setMoneyFlow] = useState([]);
    const [incomeData, setIncomeData] = useState(null);
    const [expensesData, setExpensesData] = useState(null);

    useEffect(() =&gt; {

        showLoading();
        let dt = route.params.allData;

        //money flow
        let newFlow = [];
        if (dt.moneyFlow) {
            dt.moneyFlow.forEach(element =&gt; {
                newFlow.push({
                    name: element.name === &quot;expenses&quot; ? &quot;Gastos&quot; : &quot;Receitas&quot;,
                    value: parseFloat(element.value),
                    color: element.name === &quot;expenses&quot; ? &apos;#990000&apos; : &quot;#008060&quot;
                })
            });
        }
        setMoneyFlow(newFlow);

        //income
        let incomes1 = dt.incomes;
        let newIncomes = {
            labels: [],
            datasets: [
                {
                    data: []
                }
            ]
        };
        if (incomes1) {
            incomes1.forEach(element =&gt; {
                newIncomes.labels.push(element.description);
                newIncomes.datasets[0].data.push(parseFloat(element.value));
            });
            setIncomeData(newIncomes);
        }

        //expenses
        let expenses1 = dt.expenses;
        let newExpenses = {
            labels: [],
            datasets: [
                {
                    data: []
                }
            ]
        };
        if (expenses1) {
            expenses1.forEach(element =&gt; {
                newExpenses.labels.push(element.description);
                newExpenses.datasets[0].data.push(parseFloat(element.value));
            });
            setExpensesData(newExpenses);
        }

        hideLoading();
    }, [])


    const chartConfig = {
        backgroundGradientFrom: &quot;#fff&quot;,
        backgroundGradientFromOpacity: 0,
        backgroundGradientTo: &quot;#fff&quot;,
        backgroundGradientToOpacity: 0,
        strokeWidth: 1,
        barPercentage: 0.5,
    };

    const lineChartConfig = {
        ...chartConfig,
        color: (opacity = 1) =&gt; `rgba(139, 16, 0, ${opacity})`
    }

    const barChartConfig = {
        ...chartConfig,
        color: (opacity = 1) =&gt; `rgba(0, 139, 93, ${opacity})`
    };


    return (
        &lt;View style={{ marginTop: statusBarHeight, height: &apos;100%&apos; }}&gt;
            &lt;TouchableOpacity style={styles.back} onPress={() =&gt; { navigation.navigate(&quot;Home&quot;) }}&gt;
                &lt;Ionicons name=&quot;home&quot; size={18} color=&quot;darkblue&quot; /&gt;
            &lt;/TouchableOpacity&gt;
            &lt;Text style={[styles.title, { marginTop: 8, paddingHorizontal: 8 }]}&gt;Minhas Finan&#xE7;as&lt;/Text&gt;

            &lt;ScrollView style={{ marginBottom: statusBarHeight + 20 }}&gt;

                &lt;View style={styles.graphGroup}&gt;
                    &lt;Text style={styles.graphTitle}&gt;Gastos X Receitas&lt;/Text&gt;
                    {moneyFlow ?
                        &lt;PieChart
                            data={moneyFlow}
                            width={screenWidth - 20}
                            height={220}
                            chartConfig={{
                                ...chartConfig,
                                color: () =&gt; `rgba(0, 0, 139, 1)`
                            }}
                            accessor={&quot;value&quot;}
                            backgroundColor={&quot;transparent&quot;}
                        /&gt;
                        : &lt;Text style={{ margin: 20 }}&gt;Sem dados&lt;/Text&gt;
                    }
                &lt;/View&gt;

                &lt;View style={styles.graphGroup}&gt;
                    &lt;Text style={styles.graphTitle}&gt;Receitas&lt;/Text&gt;
                    {incomeData ?
                        &lt;BarChart
                            width={screenWidth}
                            height={300}
                            data={incomeData}
                            yAxisLabel=&quot;R$&quot;
                            yLabelsOffset={0}
                            chartConfig={barChartConfig}
                            fromZero={true}
                        /&gt;
                        : &lt;Text style={{ margin: 20 }}&gt;Sem dados&lt;/Text&gt;
                    }
                &lt;/View&gt;

                &lt;View style={styles.graphGroup}&gt;
                    &lt;Text style={styles.graphTitle}&gt;Gastos&lt;/Text&gt;
                    &lt;FlashMessage duration={5000} /&gt;
                    {expensesData ?
                        &lt;LineChart
                            bezier
                            width={screenWidth - 20}
                            height={300}
                            data={expensesData}
                            yAxisLabel=&quot;R$&quot;
                            yAxisSuffix=&quot;&quot;
                            verticalLabelRotation={20}
                            chartConfig={lineChartConfig}
                            fromZero={true}
                            onDataPointClick={({ value, index, getColor }) =&gt; {
                                showMessage({
                                    message: `R$ ${value}`,
                                    description: `${expensesData.labels[index]}`,
                                    backgroundColor: getColor(.5)
                                })
                            }
                            }
                        /&gt;
                        : &lt;Text style={{ margin: 20 }}&gt;Sem dados&lt;/Text&gt;
                    }
                &lt;/View&gt;
            &lt;/ScrollView&gt;
        &lt;/View&gt;
    )
}


const styles = StyleSheet.create({
    graphTitle: {
        fontSize: 18,
        fontWeight: &apos;bold&apos;,
        marginBottom: 16,
        textAlign: &apos;center&apos;
    },
    graph: {
        fontSize: 16,
        textAlign: &apos;center&apos;
    },
    graphGroup: {
        borderWidth: 1,
        borderColor: &apos;rgba(0, 0, 139,.2)&apos;,
        margin: 10,
        padding: 5
    },
    back: {
        marginHorizontal: 10,
        marginVertical: 8,
        position: &apos;absolute&apos;,
        top: 6,
        zIndex: 99,
        borderRadius: 100,
        borderWidth: 2,
        padding: 5,
        borderColor: &apos;darkblue&apos;
    },
    title: {
        fontSize: 28,
        fontWeight: &quot;bold&quot;,
        textAlign: &quot;center&quot;
    },
})</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
